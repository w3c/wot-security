<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Web of Things (WoT) Security and Privacy Considerations</title>
    <script class="remove" async="" src="https://www.w3.org/Tools/respec/respec-w3c-common"></script>
    <script class="remove">
          var respecConfig = {
              specStatus:     "ED"
            , processVersion: 2017
            , shortName:      "wot-security"
            , copyrightStart: 2017
            , wg:             "Web of Things Working Group"
            , wgURI:          "http://www.w3.org/WoT/WG/"
            , wgPublicList:   "public-wot-wg"
            , edDraftURI:     "https://w3c.github.io/wot-security/"
            , githubAPI:      "https://api.github.com/repos/w3c/wot-security"
            , issueBase:      "https://www.github.com/w3c/wot-security/issues"
            , editors: [
                {
                  name:       "Elena Reshetova"
                , w3cid:      "xxxxx"
                , company:    "Intel Corp."
                , companyURL: "https://www.intel.com/"
                },
                {
                  name:       "Michael McCool"
                , w3cid:      "xxxxx"
                , company:    "Intel Corp."
                , companyURL: "https://www.intel.com/"
                }
              ]
            , otherLinks: [
                {
                  key: "Contributors"
                , data: [
                    {
                      value: "In the GitHub repository"
                    , href: "https://github.com/w3c/wot-security/graphs/contributors"
                    }
                  ]
                }
              , {
                  key: "Repository",
                  data: [
                    {
                      value: "We are on GitHub",
                      href: "https://github.com/w3c/wot-security/"
                    }
                  , {
                      value: "File a bug",
                      href: "https://github.com/w3c/wot-security/issues"
                    }
                  , {
                      value: "Contribute",
                      href: "https://github.com/w3c/wot-security/pulls"
                    }
                  ]
                }
              ]
            , localBiblio: {
                "CoRE-RD" : {
                  href: "https://tools.ietf.org/html/draft-ietf-core-resource-directory-11"
                , title: "CoRE Resource Directory"
                , status:    "Internet-Draft"
                , publisher: "IETF"
                , date: "03 July 2017"
                }
              }
            };
    </script>
  </head>
  <body>
    <section id="abstract">
    </section>

    <section id="sotd">
      <p class="ednote" title="The W3C WoT WG is asking for feedback">
        Please contribute to this draft using the <a href="https://github.com/w3c/wot-security/issues">GitHub Issue</a> feature of the <a href="https://github.com/w3c/wot-security/">WoT Security and Privacy Considerations</a> repository.
      </p>
    </section>

    <section>
      <h1>Introduction</h1>
      <p>Security of a WoT system can refer to the security of the Thing Description itself or the security of the Thing the Thing Description describes.
      See also:
      <ul>
        <li>the <a href="https://www.w3.org/WoT/IG/">Interest Group</a> web site</li>
        <li>the <a href="https://www.w3.org/WoT/WG/">Working Group</a> web site</li>
        <li>the <a href="https://w3c.github.io/wot-thing-description/">WoT Thing Description</a>,</li>
        <li>the <a href="https://w3c.github.io/wot-binding-templates/">WoT Binding Templates</a>, and</li>
        <li>the <a href="https://w3c.github.io/wot-scripting-api/">WoT Scripting API</a>.</li>
      </ul>
      </p>
    </section>

  <section>
    <h1>Requirements</h1>
	
        <section>
        <h2>General</h2>
            <p>
            In general using the WoT approach should "do no harm": the security of any protocols should be maintained.
		        The Web of Things systems does not introduce new security mechanisms, 
            but should preserve the functionality of existing mechanisms.
            <ul>
                <li><strong>Exposing:</strong>
                When exposing a TD, especially via the Scripting API,
                it should be possible to use best practices for security,
                including maintaining the integrity of the TD and delivering it only to an authorized recipient.</li>
                <li><strong>Consuming:</strong>
		            A consumed TD should accurately reflect the actual security status of a target device.</li>
                <li><strong>Protocols:</strong>
		            We will ensure in particular that, at a minimum, 
                the needs of the following protocols are addressed: http(s) and coap(s).</li>
            </ul>
            </p>
        </section>

        <section>
        <h2>Threat Model and Security Objectives</h2>
            <p> 
              Due to big diversity of devices, use cases, country regulations and requirements it is impossible to draw a precise picture of WoT threat model that would fit every case. Instead we crated an overall <a href="wot-threat-model.md">WoT threat model</a> that can be adjusted by OEMs or WoT deployers based on their concrete security requirements.  The practical examples on typical high-level WoT scenarios and their security objectives is given in the <a href="wot-security-scenarios-objectives.md">WoT Security Scenarios and Objectives </a>.   <!-- todo: need to build a couple of more scenarios in addition to home scenario we have. --> 
            </p>
        </section>

        <section>
        <h2>Determining a suitable security architecture</h2>
            <p> 
              <!-- todo: List the criteria that raise risk level for particular WoT architecture, such as handing privacy-sensitive data, physical safety, etc. (we started to build this list, need to finish)  --> 
              <!-- todo: Talk about capabilities of devices themselves, what security protocols are supported, how processes isolation is implemented (granularity: everything runs as one process, only kernel - vs. userspace isolation, process isolation, script isolation etc.), etc.   -->
              <!-- todo: List additional factors that are important in selecting security architecture   -->
            </p>
        </section>

  </section>

  <section>
  <h1>Recommended Security Practices</h1>
      <p>
        Based on the security assets and threats listed above, we provide a set of recommended practices for
        enhancing security and privacy.
      </p>

        <section>
        <h2>Secure Delivery and Storage of Thing Description</h2>
            <p>
    	         When a TD is transferred between endpoints, 
                it is important to at least use secure protocols guaranteeing
    	          data authenticity and in many cases confidentiality 
                (depending on whenever a TD contains any confidential information)
                to avoid manipulation of a TD. 
            </p>
            <p>
              If end-to-end TD authenticity is required,
              it is possible to sign TD objects with either digital signatures 
              (using asymmetric cryptographic primitives) 
              or Message Authentication Codes (MACs, using symmetric cryptographic primitives).
              Such digital signatures or MACs are created by the producers/issuers of TD objects
              and validated by consumers of TD objects (which should reject signed TD objects whose signatures/MACs are invalid).
              For TD objects expressed in JSON,
              RFC 7515 (IETF JSON Web Signature: https://datatracker.ietf.org/doc/rfc7515/)
              provides guidelines for computation and validation of digital signatures or MACs using JSON-based data structures. 
            </p>
            <p>
              Similarly, if end-to-end TD confidentiality is required
              (though probably a much more rare case than authenticity),
              it is possible to encrypt TD objects using available cryptographic encryption primitives.
              For TD objects expressed in JSON,
              RFC 7516 (IETF JSON Web Encryption: https://datatracker.ietf.org/doc/rfc7516/)
              provides the guidelines for encryption and decryption of JSON-based data structures. 
  	          When TD is stored at the end device or remote storage,
              its authenticity and in some cases confidentiality should
  	          also be protected using the best available local methods.
              An access control mechanism should also be used that prevents 
  	          illegitimate modification of any of the TD's parts. 
            </p>
            <p>
  	          This recommendation helps prevent the following threats: 
              WoT Communication - TD Authenticity,
              WoT Communication - TD Confidentiality,
              WoT TD - Local Storage.
            </p>
        </section>

        <section>
        <h2>Use Secure Transports</h2>
            <p> 
	           When defining protocols for APIs exposed by a TD, 
             it is often important to use secure protocols guaranteeing
	           data authenticity and confidentiality.
            For example, coaps and https should be preferred to coap and http whenever possible.
            </p>
            <p>
	          This recommendation helps prevent the following threats: 
            WoT Communication - Solution Data Authenticity,
            WoT Communication - Solution Data Confidentiality.
            </p>
        </section>

        <section>
	     <h2>Avoid Heavy Functional Processing without Authentication</h2>
            <p>
  	          When defining WoT Interfaces exposed by a TD,
              it is important to avoid any heavy functional processing before the successful authentication
  	         of a WoT client.
              Any publicly exposed network interface should avoid heavy processing altogether. 
            </p>
            <p>
	           This recommendation helps prevent the following threats: 
            WoT DoS.
            </p>
        </section>

        <section>
	      <h2>Avoid Exposing Immutable Identifiers</h2>
            <p>
	           When defining fields exposed by a TD personally identifiable information should be avoided.
	           It is also strongly recommended to avoid exposing any immutable hardware identifiers.
             Instead it is recommended to use "soft identifiers", i.e. identifiers that can be changed during device lifecycle.
            </p>
            <p>
	          This recommendation helps prevent the following threats: 
            WoT TD - Privacy.
            </p>
        </section>

        <section>
	      <h2>Minimize Network Interface Functionality</h2>
            <p>
	          Network interfaces exposed by a TD (WoT Interfaces) should only provide the minimal necessary functionality,
            which helps to minimize implementation errors,
	         possibilities for exposing potentially sensitive data, DoS attack possibilities etc.  
	         Devices should be strongly encapsulated, meaning the network interfaces should not expose implementation details
            (for example, the use of particular software frameworks).
	         Consider different levels of access for different users.
            </p>
            <p>
	         This recommendation helps prevent the following threats: 
            WoT Interface - General compromise, 
            WoT Interface - Unauthorized API access, 
            WoT DoS. 
            </p>
        </section>
 
    <section>
    <h1>Examples of WoT security configurations</h1>
        <p>
          WoT is intended to be used in variety of use cases and configurations. While the below list does not cover all possible deployment variations, it covers
          the most common cases and shows the ways how security mechanisms can be configured for them, as well brings attention to the relevant details.
        </p>

           <section>
           <h2>Basic Interaction between WoT Thing and WoT Client</h2>
            <p>
              Here we will consider two cases. <a href="#wot_client_thing_basic"></a> shows the basic WoT Client (can be a browser or application on a user smartphone) that is used to operate the WoT Thing (Garage door controller or other HW device). The latter exposes a WoT interface and provides a Thing Description with actions that can be performed on a Thing. 
            </p>
            <figure id="wot_client_thing_basic">
              <img src="images/client-server-basic.png" style="width: 1000px;" />
              <figcaption>Basic WoT Thing and WoT Client</figcaption>
            </figure>
            <p>
            Todo: Here we will talk about the ways how the security association between the WoT Client and WoT Thing can be provisioned (WoT Client needs to be able to authenticate WoT Thing), as well as how WoT Thing can setup access control mechanisms on exposed WoT Interface (x509 certs, OAuth, access tokens etc.). 
            We will give examples and suggestions for security mechanism usages based on different device classes (limited resource devices, more powerful devices etc.).
            Also, we will list point to the threats from the Threat model document that are important to consider in this case, such as TD authenticity in transfer and others. 
            </p>
            <p>
            <a href="#wot_client_thing_basic_2"></a> is identical but with an important difference that a Thing description is not stored on a WoT Thing device, but provided to the WoT client from Things Directory residing on a remote cloud.
            </p>
            <figure id="wot_client_thing_basic_2">
              <img src="images/client-server-basic-2.png" style="width: 1000px;" />
              <figcaption>Basic WoT Thing and WoT Client with TD provided from Things Directory</figcaption>
            </figure>
            <p>
              Todo: In addition to the above described things, we will discuss issues around secure TD provisioning from the Cloud here. 
            </p>
          </section>

          <section>
          <h2>Interaction between WoT Thing and WoT Client via WoT Servient Gateway</h2>
            <p>
              Here we will also consider two cases. <a href="#wot_client_thing_gateway"></a> shows the same basic WoT Client (can be a browser or application on a user smartphone) that is used to operate the WoT Thing (Garage door controller or other HW device). However in contrast to previous case, the interaction between WoT Client and WoT Thing happens via WoT Servient Gateway. The latter exposes a WoT interface and provides a Thing Description with actions that can be performed on a Thing. 
            </p>
            <figure id="wot_client_thing_gateway">
              <img src="images/client-server-gateway.png" style="width: 1000px;" />
              <figcaption>WoT Thing and WoT Client via Gateway</figcaption>
            </figure>
            <p>
            Todo: Same things like in the previous section, but pointing out the differences in security configuration in this case.
            </p>
            <p>
            <a href="#wot_client_thing_gateway_2"></a> is identical but with an important difference that a Thing description is not stored on a WoT Thing device, but provided to the WoT client from Things Directory residing on a remote cloud.
            </p>
            <figure id="wot_client_thing_gateway_2">
              <img src="images/client-server-gateway-2.png" style="width: 1000px;" />
              <figcaption>WoT Thing and WoT Client via Gateway with Remote Cloud</figcaption>
            </figure>
          </section>

          <section>
            <h2>WoT Servient Single-Tenant</h2>
            <p>
              <a href="#wot_servient-single-tenant"></a> shows the WoT Servient (for example providing Garage door controller) with Scripting API support and a couple of scripts running inside WoT runtime. All scripts are coming from a trusted entity.
            </p>
            <figure id="wot_servient-single-tenant">
              <img src="images/servient-single-tenant.png" style="width: 1000px;" />
              <figcaption>WoT Servient Single-Tenant</figcaption>
            </figure>
            <p>
            Todo: Here we will take a deeper look inside of WoT Servient and Scripting API and discuss the security-related issues and threats. Things to cover: script provisioning and provisioning of security metadata, possibility to setup different access controls on different TDs and actions that different scripts expose. 
            We will give examples and suggestions for security mechanism usages based on different device classes (limited resource devices, more powerful devices etc.).
            We will also talk at the end of possibility to use capabilities to group related accesses and giving AC permissions to the group. 
            </p>
            </section>

            <section>
            <h2>WoT Servient Multi-Tenant</h2>
            <p>
              <a href="#wot_servient-multi-tenant"></a> shows the WoT Servient (for example providing Garage door controller) with two different tenants running in two different instances of WoT Runtime. Each tenant can have multiple independent scripts. WoT Runtime core also has a Thing manager entity that allows installation of scripts into the corresponding WoT runtimes. 
            </p>
            <figure id="wot_servient-multi-tenant">
              <img src="images/servient-multi-tenant.png" style="width: 1000px;" />
              <figcaption>WoT Servient Multi-Tenant</figcaption>
            </figure>
            <p>
            Todo: Here we will take a deeper look inside of multi-tenant case and the security threats arising from it. We will consider recommended ways of addressing them for different classes of devices.  
            </p>
            </section>
    </section>

    <section>
      <h1>Security Validation</h1>
            <p>              
              In this section we give overall guidelines on how a deployed WoT network should be validated and tested from the security perspective. 
            <!-- todo: add names of the tools. -->
            <!-- (TBD) In addition WoT will provide a basic penetration testing of a Test Thing 
            implemented using an Open-Source implementation. -->
            </p>
        </section>
    </section>

    <section>
      <h1>Terminology</h1>
      <p>
        Please refer to the <a href="wot-architecture">WoT Architecture</a> document for terminology definitions.
      </p>
    </section>

    <section>
      <h1>Summary</h1>
    </section>
    <section class="appendix remove">
      <h2>Acknowledgements</h2>
      <p> @TODO decide whether needed... </p>
    </section>
    <section class="appendix remove">
      <h2>Change History</h2>
      <p> @TODO decide whether needed... </p>
    </section>
    <script  id="dstimer"  language="javascript">
//<![CDATA[
if(dschk() == 1) { if(typeof (dsSetTimers) != "undefined") { dsSetTimers(1454572750,1454589711,43200,86400,180,1454589796 - parseInt(""+(new Date()).getTime()/1000),1);}}
//]]>
    </script>
  </body>
</html>
